# Build Error #1: CSS Class Not Found

## Error Overview

**Error Type**: CSS Compilation Error  
**Affected File**: `components/CulturalShowcase/CulturalShowcase.module.css`  
**Line**: 47  
**Date**: August 24, 2025  
**Command**: `npm run dev`  

## Complete Error Message

```
⨯ ./components/CulturalShowcase/CulturalShowcase.module.css:47:3
Syntax error: The `heading-tertiary` class does not exist. If `heading-tertiary` is a custom class, make sure it is defined within a `@layer` directive.

  45 |
  46 | .dishInfo h3 {
> 47 |   @apply heading-tertiary mb-2;
     |   ^
  48 | }
  49 |
```

## Root Cause Analysis

### What Happened
The error occurs because the CSS file `CulturalShowcase.module.css` is trying to use the `@apply` directive with a class called `heading-tertiary`, but this class is not defined anywhere in the project's CSS or Tailwind configuration.

### Why It Happened
1. **Missing CSS Class Definition**: The `heading-tertiary` utility class is not defined in the global CSS file (`app/globals.css`) or in any Tailwind configuration.
2. **Incomplete Tailwind Setup**: The project appears to be using a design system with custom typography classes (`heading-primary`, `heading-secondary`, `heading-tertiary`) but these classes are not properly implemented.
3. **CSS Module + Tailwind Interaction**: The module CSS file is trying to apply a Tailwind utility that doesn't exist.

### Technical Details
- **Framework**: Next.js 14 with Tailwind CSS 3.3.5
- **CSS Processing**: PostCSS with Tailwind CSS plugin
- **Error Context**: The `@apply` directive in Tailwind CSS allows you to apply existing utility classes, but it requires those classes to actually exist
- **Module CSS**: CSS Modules allow scoped styling, but still need to reference valid CSS classes

## Impact Assessment

### Immediate Impact
- **Development Server**: Cannot start (`npm run dev` fails)
- **Build Process**: Compilation blocked
- **Component Rendering**: `CulturalShowcase` component cannot load
- **User Experience**: Application completely inaccessible

### Affected Components
- `CulturalShowcase` component (directly affected)
- Potentially other components using similar heading classes
- Overall application startup

## Step-by-Step Solution Plan

### Step 1: Investigate Current CSS Structure
1. **Check Global CSS**: Examine `app/globals.css` to see what typography classes are defined
2. **Review Tailwind Config**: Check `tailwind.config.js` for custom class definitions
3. **Audit Component CSS**: Look for other components that might use similar heading classes

### Step 2: Define Missing Typography Classes
1. **Add Typography Classes**: Create the missing `heading-tertiary` class in `app/globals.css`
2. **Implement Design System**: Define a consistent typography scale with:
   - `heading-primary` (likely H1 styles)
   - `heading-secondary` (likely H2 styles)  
   - `heading-tertiary` (likely H3 styles)
3. **Use Tailwind @layer**: Properly structure custom classes within Tailwind layers

### Step 3: Fix the CSS Module
1. **Option A - Use Existing Classes**: Replace `heading-tertiary` with standard Tailwind classes
2. **Option B - Define Custom Class**: Add the missing class to the global CSS
3. **Option C - Refactor to Tailwind**: Remove CSS modules and use Tailwind directly in JSX

### Step 4: Verify and Test
1. **Restart Development Server**: Run `npm run dev` to test the fix
2. **Check Component Rendering**: Ensure `CulturalShowcase` displays correctly
3. **Cross-browser Testing**: Verify styles work across different browsers
4. **Responsive Testing**: Ensure typography scales properly on different screen sizes

### Step 5: Prevent Future Issues
1. **Documentation**: Document the typography system in the project
2. **Linting**: Set up CSS linting to catch undefined classes early
3. **Design System**: Create a comprehensive design system file
4. **Code Review**: Establish guidelines for CSS class usage

## Recommended Implementation

### Immediate Fix (Option B - Recommended)

Add the missing typography classes to `app/globals.css`:

```css
@layer components {
  .heading-primary {
    @apply text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 leading-tight;
  }
  
  .heading-secondary {
    @apply text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 leading-tight;
  }
  
  .heading-tertiary {
    @apply text-2xl md:text-3xl font-bold text-gray-900 leading-tight;
  }
  
  .paragraph {
    @apply text-base md:text-lg text-gray-600 leading-relaxed;
  }
}
```

### Alternative Fix (Option A - Quick Fix)

Replace the problematic line in `CulturalShowcase.module.css`:

```css
/* Instead of: @apply heading-tertiary mb-2; */
.dishInfo h3 {
  @apply text-2xl font-bold text-gray-900 mb-2;
}
```

## Long-term Improvements

1. **Consistent Design System**: Establish a comprehensive typography and color system
2. **CSS Architecture**: Decide on a consistent approach (CSS Modules vs Tailwind classes vs styled-components)
3. **Documentation**: Create style guides and component documentation
4. **Tooling**: Add CSS linting and validation to prevent similar issues
5. **Testing**: Implement visual regression testing for UI components

## Prevention Strategies

1. **Pre-commit Hooks**: Add CSS validation to git hooks
2. **IDE Setup**: Configure editor with Tailwind CSS IntelliSense
3. **Build Process**: Add CSS validation step to CI/CD pipeline
4. **Code Standards**: Establish clear guidelines for CSS usage in the project
5. **Regular Audits**: Periodically review CSS for unused or undefined classes

## Related Files to Review

- `app/globals.css` - Global styles and custom classes
- `tailwind.config.js` - Tailwind configuration and custom utilities
- `components/*/*.module.css` - Other CSS modules that might have similar issues
- `components/Hero/Hero.tsx` - Likely uses `heading-primary`
- `components/ProblemSolution/ProblemSolution.tsx` - Likely uses `heading-secondary`

## Success Criteria

- [x] Development server starts without errors (`npm run dev`)
- [x] `CulturalShowcase` component renders correctly
- [x] Typography is consistent across all components
- [x] No console errors related to missing CSS classes
- [x] Responsive design works as expected
- [x] Build process completes successfully (`npm run build`)

## SOLUTION IMPLEMENTED

**Date Fixed**: August 24, 2025  
**Solution Used**: Option A - Replace with Standard Tailwind Classes  
**Status**: ✅ RESOLVED

### What Was Done

1. **Root Cause Identified**: CSS Modules cannot access custom classes defined in global `@layer components` when using `@apply`

2. **Solution Applied**: Replaced the problematic line in `CulturalShowcase.module.css`:
   ```css
   /* BEFORE (causing error): */
   .dishInfo h3 {
     @apply heading-tertiary mb-2;
   }
   
   /* AFTER (working solution): */
   .dishInfo h3 {
     @apply font-amazigh text-xl md:text-2xl font-bold text-gray-900 mb-2;
   }
   ```

3. **Cache Cleared**: Removed `.next` directory to clear compilation cache

4. **Verification**: Development server now starts successfully without errors

### Technical Explanation

The issue occurred because CSS Modules have their own scope and processing pipeline that doesn't always have access to custom classes defined in global Tailwind layers. While the `heading-tertiary` class was properly defined in `globals.css`, the CSS Module processor couldn't resolve it during compilation.

The solution maintains the exact same styling (as defined in the global `heading-tertiary` class) but uses direct Tailwind utilities that are always available to CSS Modules.

### Alternative Solutions Considered

1. **Move to JSX classes**: Use `className="heading-tertiary"` directly in the React component
2. **Redefine in CSS Module**: Add the class definition directly in the module file
3. **Use CSS-in-JS**: Convert to styled-components or similar solution

### Lessons Learned

1. **CSS Modules Limitation**: `@apply` in CSS Modules may not work with custom `@layer components` classes
2. **Direct Tailwind Classes**: Always work reliably in CSS Modules
3. **Cache Issues**: CSS compilation errors can persist in Next.js cache
4. **Consistency**: Ensure custom classes are accessible across different CSS processing contexts

### Prevention for Future

1. **Prefer JSX Classes**: Use `className` directly in React components when possible
2. **Test CSS Modules**: Always test `@apply` directives with custom classes
3. **Documentation**: Document which custom classes work in which contexts
4. **Linting**: Add CSS validation to catch these issues early